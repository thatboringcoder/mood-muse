<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mood Muse ‚Äî Shayari & Poems</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Abril+Fatface&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0b0b10;
      --card: rgba(255,255,255,0.08);
      --card-border: rgba(255,255,255,0.18);
      --text: #e8e8ef;
      --muted: #b8b8c9;
      --accent: #a8c5ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      color: var(--text);
      background: radial-gradient(60vmax 60vmax at 10% 10%, rgba(139,92,246,0.25), transparent 60%),
                  radial-gradient(50vmax 60vmax at 90% 20%, rgba(14,165,233,0.25), transparent 60%),
                  radial-gradient(70vmax 60vmax at 40% 90%, rgba(244,114,182,0.2), transparent 60%),
                  linear-gradient(160deg, #0b0b10 0%, #12121a 100%);
      min-height:100%;
      overflow-x:hidden;
    }
    .mesh-blob{ position: fixed; inset: 0; pointer-events:none; filter: blur(65px) saturate(120%); opacity:0.8; mix-blend-mode: screen; z-index:-1; }
    header{ max-width:1100px; margin: 24px auto; padding: 0 20px; display:flex; align-items:center; justify-content:space-between; }
    .logo{ display:flex; align-items:center; gap:14px; font-weight:800; letter-spacing:0.5px }
    .logo .dot{ width:14px; height:14px; border-radius:50%; background:#a78bfa; box-shadow:0 0 22px #a78bfa88 }
    .brand{ font-family: "Abril Fatface", serif; font-size: clamp(40px, 5.8vw, 72px); letter-spacing:1px; line-height:1; }
    .pill{ padding:10px 16px; border-radius:999px; background:var(--card); border:1px solid var(--card-border); font-size:12px; color:var(--muted); }
    main{ max-width:1100px; margin:0 auto; padding: 24px 20px 100px; }
    .card{ background: var(--card); border:1px solid var(--card-border); border-radius: 22px; padding: 20px 20px; backdrop-filter: blur(6px); box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
    .hero{ display:grid; grid-template-columns: 1.1fr 0.9fr; gap: 20px; align-items:stretch; }
    @media (max-width: 880px){.hero{grid-template-columns: 1fr;}}

    h1{ font-family: "Playfair Display", serif; font-weight:700; font-size: clamp(28px, 3.8vw, 48px); margin: 0 0 10px }
    h2{ font-family: "Playfair Display", serif; font-weight:600; margin: 0 0 12px }
    p.lead{ color:var(--muted); margin: 0 0 18px; line-height:1.6 }

    .fields{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px }
    .fields .full{ grid-column: 1 / -1 }
    label{ font-size:13px; color:var(--muted); margin-bottom:6px; display:block }
    input, select, textarea{ width:100%; padding: 12px 14px; border-radius:14px; background: rgba(255,255,255,0.06); border:1px solid var(--card-border); color:var(--text); outline:none; font-size:14px; }
    textarea{ min-height:84px; resize:vertical }
    .hint{ font-size:12px; color:#9aa2b1 }
    .actions{ display:flex; gap:10px; margin-top: 10px; flex-wrap:wrap }
    button{ padding: 12px 16px; border-radius:14px; background:linear-gradient(135deg, #7dd3fc, #a78bfa); color:#0b0b10; font-weight:700; border:none; cursor:pointer; box-shadow: 0 8px 22px rgba(167,139,250,0.25); }
    button.secondary{ background:transparent; color:var(--text); border:1px solid var(--card-border) }

    .emoji-bar{ display:flex; flex-wrap: wrap; gap:8px; margin: 4px 0 8px }
    .emoji-btn{ font-size:22px; padding: 8px 10px; border-radius:12px; background: rgba(255,255,255,0.06); border:1px solid var(--card-border); cursor:pointer }

    .section{ margin-top:22px }
    .poem{ padding: 16px; border-radius: 16px; background: rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.12); position:relative; overflow:hidden }
    .poem h3{ margin:0 0 6px; font-family: "Playfair Display", serif }
    .poem pre{ white-space: pre-wrap; line-height:1.7; margin: 8px 0 0; font-family: ui-serif, Georgia, "Times New Roman", Times, serif }

    .grid{ display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:14px }
    @media (max-width: 880px){.grid{grid-template-columns: 1fr;}}

    .toolbar{ display:flex; gap: 10px; align-items:center; justify-content:space-between; margin: 10px 0 6px }
    .toolbar .meta{ font-size:13px; color:var(--muted) }

    footer{ max-width:1100px; margin: 0 auto 40px; padding: 0 20px; color:var(--muted); font-size:12px; display:flex; justify-content:center }
    .tiny{ font-size:12px; color:var(--muted) }

    /* Floating micro-emoji confetti for the little-things vibe */
    .spark{ position:absolute; font-size:14px; opacity:0.65; animation: drift 6s linear infinite; pointer-events:none }
    @keyframes drift{ from{ transform: translateY(0) translateX(0) rotate(0deg) } to{ transform: translateY(-120px) translateX(40px) rotate(30deg) } }
  </style>
</head>
<body>
  <div class="mesh-blob"></div>
  <header>
    <div class="logo"><span class="dot"></span> <div class="brand">Mood&nbsp;Muse</div></div>
    <div class="pill">Aesthetic, soft vibes ‚Ä¢ Mesh gradients ‚Ä¢ Shayari + Poems</div>
  </header>
  <main>
    <section class="hero">
      <div class="card">
        <h1>Find words that match your mood.</h1>
        <p class="lead">Tell us your name, choose an emoji, drop a keyword (<em>fine</em>, <em>sad</em>, <em>happy</em>‚Ä¶), or even upload a picture. We'll curate shayaris and poems just for you.</p>
        <form id="moodForm" autocomplete="off">
          <div class="fields">
            <div>
              <label for="name">Your name</label>
              <input id="name" name="name" placeholder="e.g., Suryansh" required />
            </div>
            <div>
              <label for="language">Language / ‡§≠‡§æ‡§∑‡§æ</label>
              <select id="language" name="language">
                <option value="en">English</option>
                <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                <option value="mix">Both / ‡§¶‡•ã‡§®‡•ã‡§Ç</option>
              </select>
            </div>
            <div class="full">
              <label for="mood">How are you feeling? (keywords or emojis)</label>
              <input id="mood" name="mood" placeholder="fine, üòÑ, sad, ü•π, happy, üò¥, in love ‚ù§Ô∏è‚Ä¶" />
              <div class="emoji-bar" id="emojiBar"></div>
              <div class="hint">Prefer visuals? Upload an image‚Äîcolors & brightness help us guess the vibe. (We don‚Äôt store images.)</div>
              <input type="file" id="imgInput" accept="image/*" />
              <canvas id="imgCanvas" style="display:none"></canvas>
            </div>
          </div>
          <div class="actions">
            <button type="submit">Curate for me ‚ú®</button>
            <button type="button" class="secondary" id="randomBtn">I'm not sure ‚Äî surprise me</button>
          </div>
        </form>
      </div>
      <div class="card">
        <h2 style="margin-top:2px">Soft mesh, softer words</h2>
        <p class="lead">A gentle space for verses. We always include <em>‚ÄúI Wandered Lonely as a Cloud (Daffodils)‚Äù</em> by William Wordsworth, plus other classics and fresh shayari matched to your mood.</p>
        <div class="poem">
          <h3 style="margin:0">Why we ask mood?</h3>
          <pre>So poems meet you where you are‚Äî
not as a lecture, but a lantern.</pre>
        </div>
        <div class="tiny" style="margin-top:8px">Note: ‚ÄúDaffodils‚Äù is by William Wordsworth (often misattributed to Shakespeare!).</div>
      </div>
    </section>

    <section id="results" class="section" style="display:none">
      <div class="toolbar">
        <div class="meta" id="greeting"></div>
        <div>
          <button id="switchLang" class="secondary" title="Toggle English/Hindi">Switch Language</button>
        </div>
      </div>
      <div class="grid" id="poemGrid"></div>
    </section>
  </main>
  <footer>
    created with love ‚ù§Ô∏è by <strong>SQUADBYTE</strong>
  </footer>

  <script>
    // --- Simple animated mesh overlay ---
    (function mesh() {
      const el = document.querySelector('.mesh-blob');
      function frame(t){
        const a = Math.sin(t/2400)*30 + 30; // sizes wiggle
        const b = Math.cos(t/3100)*40 + 40;
        const c = Math.sin(t/2800 + 1.2)*50 + 50;
        el.style.background = `radial-gradient(${a}vmax ${b}vmax at ${20 + Math.sin(t/2200)*30}% ${20 + Math.cos(t/2600)*20}%, rgba(167,139,250,0.18), transparent 60%),
                                radial-gradient(${b}vmax ${c}vmax at ${80 + Math.cos(t/2000)*20}% ${25 + Math.sin(t/2400)*20}%, rgba(56,189,248,0.18), transparent 60%),
                                radial-gradient(${c}vmax ${a}vmax at ${45 + Math.sin(t/1800)*10}% ${85 + Math.cos(t/2100)*10}%, rgba(244,114,182,0.14), transparent 60%)`;
        requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
    })();

    // --- Mood detection via keywords, emoji, and image colors ---
    const EMOJI_MAP = [
      {e:'üòÄ', m:'happy'}, {e:'üòä', m:'happy'}, {e:'üòÑ', m:'happy'}, {e:'‚ú®', m:'motivated'}, {e:'üî•', m:'motivated'},
      {e:'üòî', m:'sad'}, {e:'ü•≤', m:'sad'}, {e:'üò≠', m:'sad'}, {e:'üíß', m:'sad'},
      {e:'üòå', m:'calm'}, {e:'üßò', m:'calm'}, {e:'üåø', m:'calm'}, {e:'üåä', m:'calm'},
      {e:'üò§', m:'angry'}, {e:'üò°', m:'angry'}, {e:'‚ö°', m:'angry'},
      {e:'üò≥', m:'anxious'}, {e:'ü•π', m:'anxious'}, {e:'üò¨', m:'anxious'},
      {e:'‚ù§Ô∏è', m:'love'}, {e:'üíñ', m:'love'}, {e:'üòç', m:'love'}, {e:'üíå', m:'love'},
      {e:'üò∂', m:'fine'}, {e:'üôÇ', m:'fine'}, {e:'üòê', m:'fine'},
      {e:'üï∞Ô∏è', m:'nostalgic'}, {e:'üìº', m:'nostalgic'}, {e:'üåô', m:'lonely'}, {e:'ü™ü', m:'lonely'}
    ];

    const MOOD_MAP = {
      sad: ['sad','down','heartbroken','blue','low','depressed','unhappy','gloom','upset','üò≠','üòî','ü•≤','üíß'],
      happy: ['happy','joy','glad','delighted','ecstatic','excited','good','great','üòÄ','üòä','üòÑ'],
      fine: ['fine','okay','ok','alright','meh','normal','neutral','so-so','üôÇ','üòê','üò∂','so so'],
      lonely: ['lonely','alone','isolated','solitude','missing','miss','üåô','ü™ü'],
      love: ['love','in love','crush','romantic','romance','beloved','pyaar','ishq','‚ù§Ô∏è','üíñ','üòç','üíå'],
      angry: ['angry','mad','furious','annoyed','irritated','rage','üò°','üò§','‚ö°'],
      anxious: ['anxious','anxiety','stressed','stress','worried','nervous','overwhelmed','panic','üò≥','ü•π','üò¨'],
      calm: ['calm','peaceful','relaxed','serene','chill','üßò','üåø','üåä','üòå'],
      motivated: ['motivated','inspired','driven','hustle','focus','grind','productive','‚ú®','üî•'],
      nostalgic: ['nostalgic','nostalgia','memories','missing old','yadein','‡§Ø‡§æ‡§¶‡•á‡§Ç','üï∞Ô∏è','üìº']
    };

    // Build emoji bar
    const emojiBar = document.getElementById('emojiBar');
    EMOJI_MAP.forEach(({e,m})=>{
      const b = document.createElement('button');
      b.type = 'button'; b.className = 'emoji-btn'; b.textContent = e; b.title = m;
      b.addEventListener('click', ()=>{ document.getElementById('mood').value = e; bounceSparks(e); });
      emojiBar.appendChild(b);
    });

    function inferMood(text){
      if(!text) return 'fine';
      const t = text.toLowerCase();
      for(const key in MOOD_MAP){ if(MOOD_MAP[key].some(w => t.includes(w))) return key; }
      // check single emoji fallback
      for(const {e,m} of EMOJI_MAP){ if(text.includes(e)) return m; }
      return 'fine';
    }

    // --- Image-based vibe (average color & brightness) ---
    const imgInput = document.getElementById('imgInput');
    const imgCanvas = document.getElementById('imgCanvas');
    let imageMood = null;
    imgInput.addEventListener('change', (e)=>{
      const file = e.target.files[0];
      if(!file) return; const img = new Image();
      img.onload = ()=>{
        const w = 220, h = Math.max(140, Math.round(img.height * (220/img.width)));
        imgCanvas.width = w; imgCanvas.height = h;
        const ctx = imgCanvas.getContext('2d');
        ctx.drawImage(img,0,0,w,h);
        const data = ctx.getImageData(0,0,w,h).data;
        let r=0,g=0,b=0, n=0;
        for(let i=0;i<data.length;i+=4){ r+=data[i]; g+=data[i+1]; b+=data[i+2]; n++; }
        r/=n; g/=n; b/=n;
        const max = Math.max(r,g,b), min = Math.min(r,g,b);
        const l = (max+min)/510; // 0..1
        const s = max===min?0:(max-min)/(1-Math.abs(2*l-1));
        let hdeg = 0;
        if(max===r) hdeg = 60*((g-b)/(max-min));
        else if(max===g) hdeg = 60*(2 + (b-r)/(max-min));
        else hdeg = 60*(4 + (r-g)/(max-min));
        if(isNaN(hdeg)) hdeg = 0; hdeg = (hdeg+360)%360;
        // Map simple buckets
        if(l < 0.28) imageMood = 'sad';
        else if(l > 0.78) imageMood = 'happy';
        else if(s < 0.15) imageMood = 'calm';
        else if(hdeg < 25 || hdeg > 330) imageMood = 'angry';
        else if(hdeg >=25 && hdeg < 70) imageMood = 'motivated';
        else if(hdeg >=70 && hdeg < 160) imageMood = 'calm';
        else if(hdeg >=160 && hdeg < 260) imageMood = 'lonely';
        else imageMood = 'fine';
        document.getElementById('mood').value = (document.getElementById('mood').value + ' ').trim();
        bounceSparks('üñºÔ∏è');
      };
      img.src = URL.createObjectURL(file);
    });

    // --- Library of poems/shayari (60+ pieces) ---
    const LIB = {
      en: {
        common: [
          {
            title: 'I Wandered Lonely as a Cloud (Daffodils)',
            author: 'William Wordsworth',
            content: `I wandered lonely as a cloud
That floats on high o'er vales and hills,
When all at once I saw a crowd,
A host, of golden daffodils;`
          }
        ],
        happy: [
          { title: 'Today', author: 'Original', content: `Sunlight on the desk,
a checklist finally smiling‚Äî
hello, easy day.`},
          { title: 'Boulevard', author: 'Original', content: `Caf√©s clink open;
I pocket three warm minutes
and spend them on you.`},
          { title: 'Pocket Sky', author: 'Original', content: `Clouds learn my name‚Äî
even the wind says hi
in lowercase.`}
        ],
        fine: [
          { title: 'Perfectly Ordinary', author: 'Original', content: `Some days taste like lukewarm tea;
that‚Äôs fine‚Äî
sweetness returns quietly.`},
          { title: 'Between', author: 'Original', content: `Neither storm nor sun‚Äî
just weather enough
to keep walking.`},
          { title: 'Grey Hoodie', author: 'Original', content: `Comfort has a drawstring;
I tie it once
and breathe.`}
        ],
        calm: [
          { title: 'Small Lake', author: 'Original', content: `I learn from water
how to keep moving
without making a sound.`},
          { title: 'Tea Steam', author: 'Original', content: `Let questions rise,
thin and harmless‚Äî
answers cool in time.`},
          { title: 'Quiet Switch', author: 'Original', content: `I flip the light
inside my chest
to moon.`}
        ],
        sad: [
          { title: 'Rain', author: 'Original', content: `Let the sky cry tonight;
we‚Äôll borrow its courage
and breathe again.`},
          { title: 'Street After', author: 'Original', content: `Shoelaces in puddles‚Äî
I keep walking, anyway;
my name is buoyant.`},
          { title: 'Windowpaper', author: 'Original', content: `Tape on the glass‚Äî
cracks still hold the room
together.`}
        ],
        lonely: [
          { title: 'Window', author: 'Original', content: `Streetlight on the wall‚Äî
proof that even from a distance,
things can keep you warm.`},
          { title: 'Late Inbox', author: 'Original', content: `Typing‚Ä¶ disappears.
I send myself a goodnight
and read it.`},
          { title: 'Elevator', author: 'Original', content: `We face the numbers
so we don‚Äôt have to face
our faces.`}
        ],
        love: [
          { title: 'Sonnet 18 (excerpt)', author: 'William Shakespeare', content: `Shall I compare thee to a summer‚Äôs day?
Thou art more lovely and more temperate:`},
          { title: 'Paper Boats', author: 'Original', content: `I write your name
on the margin of a cloud‚Äî
it still finds you.`},
          { title: 'Pulse', author: 'Original', content: `Your laugh teaches
my ribs to play
xylophone.`}
        ],
        angry: [
          { title: 'Breath', author: 'Original', content: `Count the tide back in‚Äî
spare the shore your storm.`},
          { title: 'Sparks', author: 'Original', content: `Keep the ember;
don‚Äôt gift the room
your wildfire.`},
          { title: 'Jaw', author: 'Original', content: `Unclench‚Äî
let the sentence end
without breaking.`}
        ],
        anxious: [
          { title: 'Anchor', author: 'Original', content: `Name five things you trust;
start with your heartbeat.
Stay.`},
          { title: 'Checklist', author: 'Original', content: `I number clouds‚Äî
by three I forget
why I was worried.`},
          { title: 'Pocket Stone', author: 'Original', content: `Smooth worry down
until it is just
another river.`}
        ],
        motivated: [
          { title: 'Begin', author: 'Original', content: `Sharpen the morning‚Äî
not with noise, but with a promise
you intend to keep.`},
          { title: 'Desk Lamp', author: 'Original', content: `Light the corner,
not the whole world‚Äî
then move the lamp.`},
          { title: 'Version', author: 'Original', content: `Ship the draft.
Perfect shows up
after hello.`}
        ],
        nostalgic: [
          { title: 'Attic Light', author: 'Original', content: `We opened a box of air‚Äî
and all the summers ran out.`},
          { title: 'Old Passwords', author: 'Original', content: `I still remember
what 2009 thought
was secret.`},
          { title: 'Bus Ticket', author: 'Original', content: `Ink faded, route gone‚Äî
my city still
knows the turn.`}
        ]
      },
      hi: {
        common: [
          { title: '‡§°‡•à‡§´‡§º‡•ã‡§°‡§ø‡§≤‡•ç‡§∏ (‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§Ö‡§Ç‡§∂)', author: '‡§µ‡§ø‡§≤‡§ø‡§Ø‡§Æ ‡§µ‡§∞‡•ç‡§°‡•ç‡§∏‡§µ‡§∞‡•ç‡§•', content: `‡§Æ‡•à‡§Ç ‡§¨‡§æ‡§¶‡§≤-‡§∏‡§æ ‡§≠‡§ü‡§ï‡§æ,
‡§™‡§π‡§æ‡§°‡§º‡§ø‡§Ø‡•ã‡§Ç-‡§ò‡§æ‡§ü‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§ä‡§™‡§∞;
‡§Ö‡§ö‡§æ‡§®‡§ï ‡§¶‡§ø‡§ñ‡•Ä‡§Ç ‡§∏‡•ã‡§®‡•á-‡§∏‡•Ä ‡§°‡•à‡§´‡§º‡•ã‡§°‡§ø‡§≤‡•á‡§Ç‚Äî
‡§ù‡•Ä‡§≤ ‡§ï‡•á ‡§™‡§æ‡§∏, ‡§™‡•á‡§°‡§º‡•ã‡§Ç ‡§§‡§≤‡•á,
‡§π‡§µ‡§æ ‡§Æ‡•á‡§Ç ‡§®‡§æ‡§ö‡§§‡•Ä, ‡§´‡§°‡§º‡§´‡§°‡§º‡§æ‡§§‡•Ä‡•§`}
        ],
        happy: [
          { title: '‡§π‡§≤‡•ç‡§ï‡•Ä ‡§∏‡•Ä ‡§ß‡•Ç‡§™', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§¨‡§æ‡§≤‡§ï‡§®‡•Ä ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§†‡•Ä ‡§ß‡•Ç‡§™,
‡§ö‡§æ‡§Ø ‡§ï‡•Ä ‡§≠‡§æ‡§™ ‡§Æ‡•á‡§Ç ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§æ‡§®‚Äî
‡§¶‡§ø‡§® ‡§Ü‡§ú ‡§Ü‡§∏‡§æ‡§®‡•§`},
          { title: '‡§ó‡•Å‡§¨‡•ç‡§¨‡§æ‡§∞‡•á', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§õ‡§§ ‡§∏‡•á ‡§¨‡§æ‡§Å‡§ß ‡§¶‡§ø‡§è
‡§¶‡•ã-‡§§‡•Ä‡§® ‡§õ‡•ã‡§ü‡•á ‡§∏‡§™‡§®‡•á‚Äî
‡§π‡§µ‡§æ ‡§®‡•á ‡§π‡§æ‡§Å ‡§ï‡§π ‡§¶‡•Ä‡•§`},
          { title: '‡§ö‡§ø‡§ü‡•ç‡§†‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ú‡•á‡§¨ ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡•Ä ‡§ö‡§ø‡§ü‡•ç‡§†‡•Ä,
‡§¨‡§ø‡§®‡§æ ‡§™‡§§‡•á ‡§ï‡•Ä‚Äî
‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§™‡§π‡•Å‡§Å‡§ö ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§`}
        ],
        fine: [
          { title: '‡§†‡•Ä‡§ï-‡§†‡§æ‡§ï', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§® ‡§®‡§∂‡•ç‡§§‡§∞-‡§∏‡§æ ‡§¶‡§∞‡•ç‡§¶,
‡§® ‡§ï‡•ã‡§à ‡§ñ‡§æ‡§∏ ‡§ñ‡•Å‡§∂‡•Ä‚Äî
‡§Ø‡§π‡•Ä ‡§≠‡•Ä ‡§è‡§ï ‡§∞‡§æ‡§π‡§§ ‡§π‡•à‡•§`},
          { title: '‡§¨‡•Ä‡§ö-‡§¨‡•Ä‡§ö', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§® ‡§Ü‡§Å‡§ß‡•Ä, ‡§® ‡§§‡•ç‡§Ø‡•å‡§π‡§æ‡§∞‚Äî
‡§¨‡§∏ ‡§á‡§§‡§®‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡§ø
‡§ö‡§≤‡§§‡•á ‡§∞‡§π‡•á‡§Ç‡•§`},
          { title: '‡§ï‡§™', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ó‡§∞‡•ç‡§Æ ‡§ï‡§™ ‡§Æ‡•á‡§Ç
‡§†‡§Ç‡§°‡•Ä ‡§∂‡§æ‡§Æ‚Äî
‡§π‡§æ‡§•‡•ã‡§Ç ‡§ï‡•ã ‡§Ø‡§ï‡§º‡•Ä‡§®‡•§`}
        ],
        calm: [
          { title: '‡§∏‡§æ‡§¶‡§æ ‡§™‡§æ‡§®‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§¨‡§π‡§®‡§æ ‡§≠‡•Ä ‡§∏‡•Ä‡§ñ‡•ã,
‡§∂‡•ã‡§∞ ‡§ï‡§ø‡§è ‡§¨‡§ø‡§®‡§æ‚Äî
‡§ú‡•à‡§∏‡•á ‡§®‡§¶‡•Ä‡•§`},
          { title: '‡§ß‡•Ä‡§Æ‡•Ä ‡§∞‡•ã‡§∂‡§®‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§¶‡•Ä‡§µ‡§æ‡§∞ ‡§™‡§∞ ‡§´‡§ø‡§∏‡§≤‡§§‡•Ä
‡§™‡•Ä‡§≤‡•Ä ‡§ï‡§ø‡§∞‡§£‚Äî
‡§ï‡§Æ‡§∞‡§æ ‡§Æ‡§®‡§æ ‡§≤‡•á‡§§‡•Ä ‡§π‡•à‡•§`},
          { title: '‡§∞‡§æ‡§§ ‡§ï‡•Ä ‡§ö‡§ø‡§ü‡•ç‡§†‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ö‡§æ‡§Å‡§¶ ‡§®‡•á ‡§≤‡§ø‡§ñ‡§æ‚Äî
‡§∏‡•ã ‡§ú‡§æ‡§ì ‡§Ö‡§¨;
‡§∏‡•Å‡§¨‡§π ‡§ú‡§µ‡§æ‡§¨ ‡§¶‡•á‡§®‡§æ‡•§`}
        ],
        sad: [
          { title: '‡§¨‡§∞‡§∏‡§æ‡§§', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§Ü‡§∏‡§Æ‡§æ‡§® ‡§∞‡•ã ‡§≤‡•á ‡§Ü‡§ú,
‡§π‡§Æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§Æ‡•Å‡§∏‡§ï‡§æ‡§è‡§Å‡§ó‡•á‚Äî
‡§Ü‡§∏‡•Ç ‡§ß‡•Å‡§≤ ‡§ú‡§æ‡§è‡§Å‡§ó‡•á‡•§`},
          { title: '‡§´‡§∞‡•ç‡§∂', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ï‡§æ‡§Å‡§ö-‡§∏‡•á ‡§¶‡§ø‡§≤ ‡§™‡§∞
‡§ï‡§æ‡§ó‡§º‡§ú‡§º-‡§∏‡•Ä ‡§™‡§ü‡•ç‡§ü‡•Ä‚Äî
‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§ö‡§≤‡§®‡§æ ‡§π‡•à‡•§`},
          { title: '‡§ï‡§æ‡§≤‡•á ‡§¨‡§æ‡§¶‡§≤', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ò‡§®‡•Ä ‡§∏‡•ç‡§Ø‡§æ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§≠‡•Ä
‡§ï‡•Å‡§õ ‡§∏‡§ø‡§§‡§æ‡§∞‡•á ‡§¨‡§ö‡§§‡•á ‡§π‡•à‡§Ç‚Äî
‡§µ‡§π‡•Ä ‡§∞‡§æ‡§π ‡§¨‡§®‡•á‡§Ç‡§ó‡•á‡•§`}
        ],
        lonely: [
          { title: '‡§ñ‡§ø‡§°‡§º‡§ï‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§∏‡§°‡§º‡§ï-‡§¨‡§§‡•ç‡§§‡•Ä ‡§ï‡•Ä ‡§≤‡•å,
‡§¶‡•Ç‡§∞ ‡§∏‡•á ‡§≠‡•Ä ‡§∏‡§Æ‡§ù‡§æ‡§§‡•Ä ‡§π‡•à‚Äî
‡§∞‡§ø‡§∂‡•ç‡§§‡•á ‡§™‡§æ‡§∏ ‡§π‡•à‡§Ç‡•§`},
          { title: '‡§∏‡•Ä‡§¢‡§º‡§ø‡§Ø‡§æ‡§Å', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§è‡§ï-‡§è‡§ï ‡§™‡§æ‡§Ø‡§¶‡§æ‡§® ‡§™‡§∞
‡§Æ‡•á‡§∞‡•á ‡§ï‡§¶‡§Æ ‡§î‡§∞ ‡§Æ‡•á‡§∞‡•Ä
‡§ß‡§°‡§º‡§ï‡§® ‡§∏‡§æ‡§•‡•§`},
          { title: '‡§∏‡•ç‡§ü‡•á‡§∂‡§®', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ò‡§°‡§º‡•Ä ‡§∞‡•Å‡§ï‡•Ä ‡§®‡§π‡•Ä‡§Ç,
‡§ü‡•ç‡§∞‡•á‡§® ‡§≠‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä‚Äî
‡§Æ‡•à‡§Ç ‡§≠‡•Ä ‡§ú‡§æ‡§ä‡§Å‡§ó‡§æ‡•§`}
        ],
        love: [
          { title: '‡§ó‡§º‡§æ‡§≤‡§ø‡§¨ (‡§∂‡•á‡§∞)', author: '‡§Æ‡§ø‡§∞‡•ç‡§ú‡§º‡§æ ‡§ó‡§º‡§æ‡§≤‡§ø‡§¨', content: `‡§π‡§ú‡§º‡§æ‡§∞‡•ã‡§Ç ‡§ñ‡§º‡•ç‡§µ‡§æ‡§π‡§ø‡§∂‡•á‡§Ç ‡§ê‡§∏‡•Ä ‡§ï‡§ø ‡§π‡§∞ ‡§ñ‡§º‡•ç‡§µ‡§æ‡§π‡§ø‡§∂ ‡§™‡•á ‡§¶‡§Æ ‡§®‡§ø‡§ï‡§≤‡•á,
‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§ï‡§≤‡•á ‡§Æ‡•á‡§∞‡•á ‡§Ö‡§∞‡§Æ‡§æ‡§®, ‡§≤‡•á‡§ï‡§ø‡§® ‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§ï‡§Æ ‡§®‡§ø‡§ï‡§≤‡•á‡•§`},
          { title: '‡§ï‡§æ‡§ó‡§º‡§ú‡§º ‡§ï‡•Ä ‡§®‡§æ‡§µ', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§§‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡§ï‡§∞
‡§¨‡§æ‡§¶‡§≤ ‡§ï‡•Ä ‡§ß‡§æ‡§∞ ‡§™‡§∞‚Äî
‡§¨‡§∞‡§∏ ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§Æ‡§ø‡§≤‡§§‡•á ‡§π‡•à‡§Ç‡•§`},
          { title: '‡§ß‡§°‡§º‡§ï‡§®', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§§‡•á‡§∞‡•Ä ‡§π‡§Å‡§∏‡•Ä ‡§®‡•á
‡§Æ‡•á‡§∞‡•Ä ‡§™‡§∏‡§≤‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã
‡§∞‡§æ‡§ó ‡§∏‡§ø‡§ñ‡§æ ‡§¶‡§ø‡§Ø‡§æ‡•§`}
        ],
        angry: [
          { title: '‡§†‡§π‡§∞‡•ã', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§≤‡§´‡§º‡•ç‡§ú‡§º‡•ã‡§Ç ‡§ï‡•ã ‡§ß‡§æ‡§∞ ‡§® ‡§¶‡•ã‚Äî
‡§ö‡•Å‡§™‡•ç‡§™‡•Ä ‡§≠‡•Ä ‡§∏‡§Æ‡§ù‡§æ‡§§‡•Ä ‡§π‡•à‡•§`},
          { title: '‡§¶‡§π‡§≤‡•Ä‡§ú‡§º', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ó‡§º‡•Å‡§∏‡•ç‡§∏‡§æ ‡§¶‡§∞‡§µ‡§æ‡§ú‡§º‡•á ‡§§‡§ï‚Äî
‡§Ö‡§Ç‡§¶‡§∞ ‡§∞‡§ø‡§∂‡•ç‡§§‡•á ‡§∞‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§`},
          { title: '‡§Æ‡•Å‡§ü‡•ç‡§†‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ñ‡•Å‡§≤ ‡§ú‡§æ‡§è ‡§§‡•ã
‡§π‡§µ‡§æ ‡§≠‡•Ä ‡§Ö‡§™‡§®‡•Ä ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‚Äî
‡§ñ‡•ã‡§≤ ‡§¶‡•ã‡•§`}
        ],
        anxious: [
          { title: '‡§∏‡§æ‡§Å‡§∏', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§™‡§æ‡§Å‡§ö ‡§≠‡§∞‡•ã‡§∏‡•á ‡§ó‡§ø‡§®‡•ã‚Äî
‡§™‡§π‡§≤‡§æ, ‡§Ö‡§™‡§®‡•Ä ‡§ß‡§°‡§º‡§ï‡§®;
‡§¨‡§æ‡§ï‡§º‡•Ä ‡§ñ‡•Å‡§¶ ‡§Ü ‡§ú‡§æ‡§è‡§Å‡§ó‡•á‡•§`},
          { title: '‡§ó‡§ø‡§®‡§§‡•Ä', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§¨‡§æ‡§¶‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§ó‡§ø‡§®‡§§‡•á-‡§ó‡§ø‡§®‡§§‡•á
‡§ò‡§¨‡§∞‡§æh‡§ü ‡§â‡§§‡§∞‡§§‡•Ä ‡§π‡•à‚Äî
‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§∞‡§π ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§`},
          { title: '‡§ï‡§Ç‡§ï‡§°‡§º', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ú‡•á‡§¨ ‡§ï‡§æ ‡§õ‡•ã‡§ü‡§æ ‡§™‡§§‡•ç‡§•‡§∞‚Äî
‡§ö‡§ø‡§®‡•ç‡§§‡§æ ‡§ò‡§ø‡§∏‡§§‡•á-‡§ò‡§ø‡§∏‡§§‡•á
‡§Æ‡•Å‡§≤‡§æ‡§Ø‡§Æ ‡§π‡•ã ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§`}
        ],
        motivated: [
          { title: '‡§Ü‡§∞‡§Ç‡§≠', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§∏‡•Å‡§¨‡§π ‡§ï‡•ã ‡§§‡•á‡§ú‡§º ‡§ï‡§∞‡•ã,
‡§∂‡•ã‡§∞ ‡§∏‡•á ‡§®‡§π‡•Ä‡§Ç‚Äî
‡§è‡§ï ‡§∏‡§ö‡•ç‡§ö‡•á ‡§µ‡§æ‡§¶‡•á ‡§∏‡•á‡•§`},
          { title: '‡§¶‡•Ä‡§™‡§ï', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§™‡§π‡§≤‡•á ‡§ï‡•ã‡§®‡§æ ‡§ú‡§ó‡§æ‡§ì,
‡§´‡§ø‡§∞ ‡§™‡•Ç‡§∞‡•Ä ‡§∞‡•å‡§∂‡§®‡•Ä‚Äî
‡§Ø‡§π‡•Ä ‡§§‡§∞‡§ï‡§º‡•ç‡§ï‡§º‡•Ä ‡§π‡•à‡•§`},
          { title: '‡§Æ‡•Å‡§∏‡§µ‡•ç‡§µ‡§¶‡§æ', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ñ‡§º‡§§ ‡§≠‡•á‡§ú‡•ã ‡§™‡§π‡§≤‡•á‚Äî
‡§¨‡•á‡§π‡§§‡§∞‡§ø‡§Ø‡§æ‡§Å
‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à‡§Ç‡•§`}
        ],
        nostalgic: [
          { title: '‡§¨‡§ï‡•ç‡§∏‡§æ', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§¨‡§ï‡•ç‡§∏‡§æ ‡§ñ‡•ã‡§≤‡§æ,
‡§î‡§∞ ‡§∏‡§æ‡§∞‡•á ‡§∏‡§æ‡§µ‡§® ‡§â‡§°‡§º ‡§™‡§°‡§º‡•á‡•§`},
          { title: '‡§ü‡•á‡§™', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§ï‡•à‡§∏‡•á‡§ü ‡§â‡§≤‡§ü‡•Ä‚Äî
‡§Ø‡§æ‡§¶‡•á‡§Ç ‡§∏‡§π‡•Ä-‡§∏‡§π‡•Ä
‡§ö‡§≤ ‡§™‡§°‡§º‡•Ä‡§Ç‡•§`},
          { title: '‡§∏‡•ç‡§ï‡•Ç‡§≤ ‡§¨‡•á‡§≤', author: '‡§Æ‡•å‡§≤‡§ø‡§ï', content: `‡§Ü‡§ß‡•Ä ‡§õ‡•Å‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä
‡§Ü‡§µ‡§æ‡§ú‡§º ‡§Ü‡§ú ‡§≠‡•Ä
‡§≠‡•Ç‡§ñ ‡§¨‡§¢‡§º‡§æ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡•§`}
        ]
      }
    };

    function pickByMood(lang, mood){
      const list = [];
      list.push(...LIB[lang].common);
      const moodList = LIB[lang][mood] || LIB[lang].fine;
      list.push(...moodList);
      return list;
    }

    function renderPoems(lang, mood){
      const grid = document.getElementById('poemGrid');
      const items = pickByMood(lang, mood);
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'poem';
        card.innerHTML = `<h3>${item.title}</h3><div class="tiny">by ${item.author} ‚Ä¢ ${lang === 'en' ? 'English' : '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä'}</div><pre>${item.content}</pre>`;
        sprinkle(card, mood);
        grid.appendChild(card);
      });
    }

    function updateGreeting(name, mood, lang){
      const moodNice = mood.charAt(0).toUpperCase() + mood.slice(1);
      const langNice = lang === 'en' ? 'English' : (lang === 'hi' ? '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä' : 'Both');
      document.getElementById('greeting').textContent = `Hi ${name} ‚Äî mood sensed: ${moodNice} ‚Ä¢ language: ${langNice}`;
    }

    const form = document.getElementById('moodForm');
    const results = document.getElementById('results');
    const switchBtn = document.getElementById('switchLang');

    let STATE = { name: '', mood: 'fine', lang: 'en' };

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const name = document.getElementById('name').value.trim() || 'Friend';
      const lang = document.getElementById('language').value;
      const moodText = document.getElementById('mood').value;
      const mEmoji = inferMood(moodText);
      const mood = imageMood || mEmoji || 'fine';
      STATE = { name, mood, lang };
      localStorage.setItem('moodMuse', JSON.stringify(STATE));
      results.style.display = 'block';
      document.getElementById('poemGrid').innerHTML='';
      updateGreeting(name, mood, lang === 'mix' ? 'en' : lang);
      renderPoems(lang === 'mix' ? 'en' : lang, mood);
      if(lang === 'mix'){
        const sep = document.createElement('div');
        sep.className = 'tiny'; sep.style.margin = '6px 0'; sep.textContent = '‚Äî ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‚Äî';
        document.getElementById('poemGrid').appendChild(sep);
        renderPoems('hi', mood);
      }
      window.scrollTo({ top: results.offsetTop - 10, behavior: 'smooth' });
      imageMood = null; // reset after use
    });

    document.getElementById('randomBtn').addEventListener('click', ()=>{
      const names = [' Dost ', ' Mitra ', ' ÿØŸàÿ≥ÿ™ ', ' Friend '];
      document.getElementById('name').value = names[Math.floor(Math.random()*names.length)].trim();
      document.getElementById('mood').value = ['fine','happy','calm','sad','lonely','love','anxious','motivated','nostalgic','angry'][Math.floor(Math.random()*10)];
      form.dispatchEvent(new Event('submit'));
    });

    switchBtn.addEventListener('click', ()=>{
      if(!results.style.display || results.style.display === 'none') return;
      const nextLang = STATE.lang === 'en' ? 'hi' : 'en';
      STATE.lang = nextLang;
      document.getElementById('poemGrid').innerHTML='';
      updateGreeting(STATE.name, STATE.mood, nextLang);
      renderPoems(nextLang, STATE.mood);
    });

    // Restore state if available
    try{
      const saved = JSON.parse(localStorage.getItem('moodMuse'));
      if(saved && saved.name){
        STATE = saved; 
        document.getElementById('name').value = STATE.name;
        document.getElementById('language').value = STATE.lang;
        document.getElementById('mood').value = STATE.mood;
        results.style.display = 'block';
        document.getElementById('poemGrid').innerHTML='';
        updateGreeting(STATE.name, STATE.mood, STATE.lang === 'mix' ? 'en' : STATE.lang);
        renderPoems(STATE.lang === 'mix' ? 'en' : STATE.lang, STATE.mood);
        if(STATE.lang === 'mix'){
          const sep = document.createElement('div');
          sep.className = 'tiny'; sep.style.margin = '6px 0'; sep.textContent = '‚Äî ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‚Äî';
          document.getElementById('poemGrid').appendChild(sep);
          renderPoems('hi', STATE.mood);
        }
      }
    }catch{}

    // tiny animated emoji sparks based on mood
    const MOOD_SPARK = {
      happy:['‚ú®','üå§Ô∏è','ü•∞'],
      fine:['üå´Ô∏è','üå§Ô∏è','‚ú®'],
      calm:['üåô','üåø','ü´ñ'],
      sad:['üíß','üåßÔ∏è','üå´Ô∏è'],
      lonely:['ü™ü','üåô','üåå'],
      love:['‚ù§Ô∏è','üíñ','üå∏'],
      angry:['‚ö°','üî•','üí¢'],
      anxious:['ü´®','üåÄ','ü´Å'],
      motivated:['üöÄ','‚ú®','üìå'],
      nostalgic:['üìº','üï∞Ô∏è','üåÜ']
    };
    function sprinkle(node, mood){
      const list = MOOD_SPARK[mood] || ['‚ú®'];
      for(let i=0;i<3;i++){
        const s = document.createElement('div');
        s.className='spark';
        s.textContent = list[i%list.length];
        s.style.left = (8 + Math.random()*60)+'%';
        s.style.bottom = (-6 + Math.random()*8)+'px';
        s.style.animationDelay = (Math.random()*2)+'s';
        node.appendChild(s);
      }
    }
    function bounceSparks(e){
      const btns = document.querySelectorAll('.emoji-btn');
      btns.forEach(b=>{ if(b.textContent===e){ b.animate([{transform:'scale(1)'},{transform:'scale(1.25)'},{transform:'scale(1)'}],{duration:300, easing:'ease'}); } });
    }
  </script>
</body>
</html>
